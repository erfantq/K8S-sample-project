# ๐งญ ูุณุชูุฏุงุช ูพุฑูฺู ฺฉูุจุฑูุชุฒ

## ๐ ูุนุฑู ูพุฑูฺู
ุงู ูพุฑูฺู ุดุงูู ููุงุฌุฑุช ฺฉ ุงูพูฺฉุดู ุณู ูุงู **(Web, App, DB)** ุงุฒ ูุญุท **Docker Compose** ุจู ุงุฑฺฉุณุชุฑุงุชูุฑ **Kubernetes** ุงุณุช.  
ูพุงุฏูโุณุงุฒ ุจุฑ ุฑู ฺฉูุงุณุชุฑ ูุญู **Kind** ุงูุฌุงู ุดุฏู ู ุชูุงู ูุงุฒููุฏโูุง ูพุฑูฺู ุดุงูู ููุงุฑุฏ ุงุฌุจุงุฑ ู ุงุฎุชุงุฑ **(Redis, NetworkPolicy, Monitoring)** ูพุงุฏูโุณุงุฒ ุดุฏูโุงูุฏ.

---

## ๐ ุณุงุฎุชุงุฑ ูุงูโูุง
ุทุจู ุฎูุงุณุชู ูพุฑูฺูุ ูุงูโูุง YAML ุจุฑ ุงุณุงุณ ูุธูู ู ููุน ุณุฑูุณ ุฏุฑ ูพูุดูโูุง ูุฌุฒุง ุฏุณุชูโุจูุฏ ุดุฏูโุงูุฏ:

```text
k8s/
โโโ base/           # ุชูุธูุงุช ุฒุฑุณุงุฎุช (Namespace, Manual PV)
โโโ db/             # ุชูุธูุงุช ุฏุชุงุจุณ (StatefulSet, Service, Secret)
โโโ backend/        # ุชูุธูุงุช ุงูพูฺฉุดู (Deployment, ConfigMap, HPA)
โโโ nginx/          # ุชูุธูุงุช ูุจโุณุฑูุฑ (ConfigMap, Deployment, Service)
โโโ redis/          # ุชูุธูุงุช ฺฉุด (Deployment, Service)
โโโ security/       # ุณุงุณุชโูุง ุงููุช ุดุจฺฉู (NetworkPolicy)
โโโ monitoring/     # ูุงูุชูุฑูฺฏ (Prometheus, Grafana, RBAC)
```
---

## ๐ ุฑุงูููุง ูุตุจ ู ุงุฌุฑุง

### 1. ูพุดโูุงุฒูุง

ุจุฑุง ุงุฌุฑุง ูพุฑูฺู ูุงุฒ ุจู ุงุจุฒุงุฑูุง ุฒุฑ ุฏุงุฑุฏ:

* Docker
* Kind
* Kubectl

---

### 2. ุขูุงุฏูโุณุงุฒ ฺฉูุงุณุชุฑ ู ุงูุฌ

ุงุจุชุฏุง ฺฉูุงุณุชุฑ ุฑุง ุงุฌุงุฏ ฺฉุฑุฏู ู ุงูุฌ ุงูพูฺฉุดู ุฑุง ุจูุฏ ูโฺฉูู.
**ูฺฉุชู ููู** ุฏุฑ Kind ุงู ุงุณุช ฺฉู ุจุงุฏ ุงูุฌ ุฑุง ูพุณ ุงุฒ ุณุงุฎุชุ ุฏุฑ ููุฏูุง ฺฉูุงุณุชุฑ ุจุงุฑฺฏุฐุงุฑ ฺฉูู:

```bash
# ุงุฌุงุฏ ฺฉูุงุณุชุฑ
kind create cluster --name my-project

# ุณุงุฎุช ุงูุฌ ุงูพูฺฉุดู (ุฏุฑ ุฑูุช ูพุฑูฺู)
docker build -t my-app:1.0 ./app

# ุจุงุฑฺฏุฐุงุฑ ุงูุฌ ุฏุฑ ฺฉูุงุณุชุฑ Kind
kind load docker-image my-app:1.0 --name my-project
```

---

### 3. ุงุฌุฑุง ุณุฑูุณโูุง

ุจุฑุง ุงุนูุงู ุชูุงู ูุงูโูุง ฺฉุงููฺฏ ุจู ุตูุฑุช ฺฉุฌุง ู ุฑุนุงุช ุณุงุฎุชุงุฑ ูพูุดูโุจูุฏ:

```bash
kubectl apply -f k8s/ --recursive
```

---

### 4. ุจุฑุฑุณ ูุถุนุช

ุจุฑุง ุงุทููุงู ุงุฒ ุตุญุช ุงุฌุฑุง:

```bash
kubectl get pods -n user-system
```

> ุชูุงู ูพุงุฏูุง ุฏุชุงุจุณุ ุจฺฉโุงูุฏุ ุงูุฌูโุงฺฉุณ ู ุณุฑูุณโูุง ูุงูุชูุฑูฺฏ ุจุงุฏ ุฏุฑ ูุถุนุช **Running** ุจุงุดูุฏ.

![Pods status](./screenshots/pods-status.png)

---

## ๐ ูุญูู ุงุชุตุงู ุณุฑูุณโูุง

ุฏุฑ ุงู ูพุฑูฺู ุงุฒ **DNS ุฏุงุฎู Kubernetes (CoreDNS)** ุจุฑุง ุงุฑุชุจุงุท ุณุฑูุณโูุง ุงุณุชูุงุฏู ุดุฏู ุงุณุช:

| ุณุฑูุณ ูุจุฏุฃ              | ุณุฑูุณ ููุตุฏ                                 | ุชูุถุญ                     |
| ----------------------- | ------------------------------------------ | ------------------------- |
| **Nginx โก๏ธ Backend**    | `app.user-system.svc.cluster.local:5000`   | ูุฏุงุช ุฏุฑุฎูุงุณุชโูุง ฺฉุงุฑุจุฑุงู |
| **Backend โก๏ธ Database** | `mysql-0.db.user-system.svc.cluster.local` | ุงุชุตุงู ูพุงุฏุงุฑ StatefulSet  |
| **Backend โก๏ธ Redis**    | `redis.user-system.svc.cluster.local`      | ูุฏุฑุช ฺฉุด ู ุฏุงุฏู ูููุช     |

๐ **ุงููุช ุดุจฺฉู:**
ุจุง NetworkPolicy ููุท ูพุงุฏูุง **backend** ุงุฌุงุฒู ุงุชุตุงู ูุณุชูู ุจู **DB** ู **Redis** ุฑุง ุฏุงุฑูุฏ.

---

## ๐ ฺุงูุดโูุง ู ูุญูู ุฑูุน ุงุดฺฉุงู

### 5. ูุดฺฉู Pending ูุงูุฏู ุฏุชุงุจุณ (Issue ูุฑุชุจุท ุจุง PVC ุฏุฑ Kind)

**ูุดฺฉู:**
ูพุงุฏ `mysql-0` ุฏุฑ ูุถุนุช Pending ุจุงู ูโูุงูุฏ. Provisioner ูพุดโูุฑุถ Kind ูุงุฏุฑ ุจู ุงุฎุชุตุงุต ุฏุณฺฉ ูุจูุฏ.

**ุฑุงูโุญู:**

* ุชุนุฑู ฺฉ **PersistentVolume ุฏุณุช** ุจุง HostPath
* ุงุฌุงุฏ **StorageClass** ุจุง ุชูุธู:

```yaml
volumeBindingMode: Immediate
```

ุงู ฺฉุงุฑ ุจุงุนุซ ุณุงุฎุช ููุฑ Volume ู ุฑูุน ูุดฺฉู Pending ุดุฏ.

---

### 6. ูุดฺฉู DNS Resolution (CoreDNS Loop)

**ูุดฺฉู:**
ุณุฑูุณโูุง ุจุง ุฎุทุง ุฒุฑ ููุงุฌู ุจูุฏูุฏ:

```
Host not found
```

ู ูพุงุฏ `coredns` ุฏุฑ ูุถุนุช `0/1` ูุฑุงุฑ ุฏุงุดุช. ูุงฺฏโูุง ุฎุทุง `Loop detected` ุฑุง ูุดุงู ูโุฏุงุฏูุฏ.

**ุฑุงูโุญู:**

```bash
kubectl edit configmap coredns -n kube-system
```

* ุญุฐู ูพูุงฺฏู **loop**
* ุฑุณุชุงุฑุช CoreDNS
* ูุนุงู ุดุฏู ุณุฑูุณ ูุงูโฺฏุฐุงุฑ ู ุฑูุน ูุดฺฉู ุงุฑุชุจุงุท ุจู ุณุฑูุณโูุง

---

## ๐งช ูุญูู ุชุณุช ูพุฑูฺู

ฺูู ูพุฑูฺู ุฑู Kind ุงุฌุฑุง ูโุดูุฏุ ุจุฑุง ุชุณุช ุงุฒ **Port Forwarding** ุงุณุชูุงุฏู ูโฺฉูู.

### ๐ ุชุณุช ุงูพูฺฉุดู (Nginx)

```bash
kubectl port-forward service/nginx-service 8080:8000 -n user-system
```

![about-page](./screenshots/about-page.png)
![home-page](./screenshots/home-page.png)
![student-page](./screenshots/student-page.png)


ูุณุฑูุง ูุงุจูโุฏุณุชุฑุณ ุฏุฑ ูุฑูุฑฺฏุฑ:

| ูุณุฑ          | ุชูุถุญ         |
| ------------- | ------------- |
| `/`           | ุตูุญู ุงุตู     |
| `/home`       | ุตูุญู ุฎุงูู     |
| `/4012262209` | ูุณุฑ ุฏุงูุดุฌู |

---

### ๐ ูุดุงูุฏู ูุงูุชูุฑูฺฏ (Grafana)

```bash
kubectl port-forward service/grafana 3000:3000 -n user-system
```

* ุขุฏุฑุณ: [http://localhost:3000](http://localhost:3000)
* **User:** `admin`
* **Pass:** `admin123`

![monitoring-image](./screenshots/monitoring.png)

---

## ๐ ูพุงุงู ฺฏุฒุงุฑุด

ุงู ูพุฑูฺู ุจุง ููููุช ููุงุฌุฑุช ุงูพูฺฉุดู Docker Compose ุจู Kubernetes ุฑุง ููุฑุงู ุจุง ููุงูู ฺฉูุฏ ุฒุฑ ูพุงุฏูโุณุงุฒ ฺฉุฑุฏู ุงุณุช:

โ๏ธ StatefulSet
โ๏ธ Storage ู Volume
โ๏ธ NetworkPolicy
โ๏ธ CoreDNS
โ๏ธ Port Forwarding
โ๏ธ Monitoring (Grafana + Prometheus)

---


